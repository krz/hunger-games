"use strict";(self.webpackChunkhunger_game=self.webpackChunkhunger_game||[]).push([[713],{667:function(n,i,e){var t=e(1413),o=e(9439),r=e(5987),s=e(9867),l=e(8386),a=e(2541),u=e(9830),d=e(4964),c=e(7298),v=e(5226),g=e(9346),h=e(98),x=e(7237),f=e(5940),Z=e(489),m=e(8907),p=e(8357),j=e(301),_=e(2689),b=e(2834),y=["src","srcFull","zoomIn","imageProps"];i.Z=function(n){var i=n.src,e=n.srcFull,k=n.zoomIn,q=n.imageProps,w=(0,r.Z)(n,y),I=s.useRef(null),P=s.useState(0),C=(0,o.Z)(P,2),S=C[0],F=C[1],N=s.useState(!1),z=(0,o.Z)(N,2),L=z[0],U=z[1],T=(0,_.Z)(),E=(0,j.Z)(T.breakpoints.down("md"));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",(0,t.Z)((0,t.Z)({},w),{},{style:(0,t.Z)((0,t.Z)({},w.style),{},{position:"relative"}),children:[k?(0,b.jsx)(f.d$,{children:(0,b.jsx)(f.Uv,{children:(0,b.jsx)("img",(0,t.Z)({src:i,alt:""},q))})}):(0,b.jsx)("img",(0,t.Z)({src:i,alt:""},q)),(0,b.jsx)(g.Z,{onClick:function(){U(!0)},sx:function(n){return{position:"absolute",color:"white",backgroundColor:(0,x.Fq)(n.palette.secondary.main,.5),bottom:5,right:5}},children:(0,b.jsx)(p.Z,{})})]})),(0,b.jsxs)(l.Z,{open:L,onClose:function(){U(!1)},maxWidth:"xl",fullScreen:E,children:[(0,b.jsx)(c.Z,{sx:{p:1,display:"flex",flexDirection:"row-reverse"},children:(0,b.jsx)(g.Z,{onClick:function(){return U(!1)},children:(0,b.jsx)(h.Z,{})})}),(0,b.jsx)(v.Z,{}),(0,b.jsx)(u.Z,{sx:{p:{xs:1,md:2}},children:(0,b.jsx)(f.d$,{limitToBounds:!1,ref:I,children:(0,b.jsx)(f.Uv,{children:(0,b.jsx)("img",{src:null!==e&&void 0!==e?e:i,alt:"",style:{maxHeight:"calc(100vh - 160px )",maxWidth:"min(100%, 1400px)",transform:"rotate(".concat(90*S,"deg)"),transformOrigin:"center"}})})})}),(0,b.jsxs)(a.Z,{children:[(0,b.jsx)(d.Z,{fullWidth:!0,variant:"outlined",onClick:function(){F((function(n){return n-1}))},startIcon:(0,b.jsx)(Z.Z,{}),children:"left"}),(0,b.jsx)(d.Z,{fullWidth:!0,onClick:function(){var n;F(0),null===(n=I.current)||void 0===n||n.resetTransform()},children:"Reset"}),(0,b.jsx)(d.Z,{fullWidth:!0,variant:"outlined",onClick:function(){F((function(n){return n+1}))},endIcon:(0,b.jsx)(m.Z,{}),children:"right"})]})]})]})}},3449:function(n,i,e){var t=e(8025),o=e.n(t),r={addImageFlag:function(n){var i=n.barcode,e=n.imgid,t=n.url;o().put("https://amathjourney.com/api/off-annotation/flag-image/".concat(i),{mode:"no-cors",imgid:e,url:t}).catch((function(){console.log("Image flagged")}))},removeImageFlag:function(n){var i=n.barcode,e=n.imgid;o().delete("https://amathjourney.com/api/off-annotation/flag-image/".concat(i),{mode:"no-cors",data:{imgid:e}}).catch((function(){console.log("Something went wrong. Image could not be flagged")}))}};i.ZP=r},8164:function(n,i,e){e.d(i,{n:function(){return a}});var t,o=e(4942),r=e(5921),s=e(9025),l=(t={},(0,o.Z)(t,s.Q8,"yes"),(0,o.Z)(t,s.hN,"no"),(0,o.Z)(t,s.PF,"skip"),t),a=function(){var n=(0,r.Z)().trackEvent;return{answerQuestions:function(i){n({category:"question-page",action:l[i]})},annotateLogo:function(i){var e=i.game,t=i.type,o=i.value,r=i.number;n({category:"logo",action:"annotation",name:"".concat(e," - ").concat(t," - ").concat(o),value:r})}}}},6713:function(n,i,e){e.r(i),e.d(i,{default:function(){return kn}});var t=e(9867),o=e(4416),r=e(1413),s=e(9439),l=e(5644),a=e(4964),u=e(4249),d=e(7298),c=e(5226),v=e(3248),g=e(8547),h=e(8430),x=e(8018),f=e(6761),Z=e(8514),m=e(9079),p=e(2689),j=e(301),_=e(2418),b=e(3094),y=e(9025),k=e(5607),q=e(4754),w=e(8164),I=e(5726),P=e(3843),C={en:{yes:"y",no:"n",skip:"k"},fr:{yes:"o",no:"n",skip:"k"}},S=e(5987),F=e(4165),N=e(5861),z=e(3768),L=e(3547),U=e(2834),T=["insightId"],E=function(){var n=(0,N.Z)((0,F.Z)().mark((function n(i){var e,t,o,s,l,a,u,d,c,v,g,h,x;return(0,F.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,z.Z.insightDetail(i);case 2:if(null===(a=n.sent)||void 0===a||null===(e=a.data)||void 0===e||!e.source_image||null===a||void 0===a||null===(t=a.data)||void 0===t||null===(o=t.data)||void 0===o||!o.logo_id||null!==a&&void 0!==a&&null!==(s=a.data)&&void 0!==s&&null!==(l=s.data)&&void 0!==l&&l.bounding_box){n.next=9;break}return n.next=6,z.Z.getLogosImages([null===a||void 0===a||null===(u=a.data)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.logo_id]);case 6:return h=n.sent,x=null===h||void 0===h||null===(c=h.data)||void 0===c||null===(v=c.logos)||void 0===v||null===(g=v[0])||void 0===g?void 0:g.bounding_box,n.abrupt("return",(0,r.Z)((0,r.Z)({},a),{},{bounding_box:x}));case 9:return n.abrupt("return",a);case 10:case"end":return n.stop()}}),n)})));return function(i){return n.apply(this,arguments)}}(),Q=function(n){var i,e=null===n||void 0===n?void 0:n.data,t=(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.bounding_box)||(null===n||void 0===n?void 0:n.bounding_box);if(null===e||void 0===e||!e.source_image||!t)return null;var o=L.Z.getImageUrl(null===e||void 0===e?void 0:e.source_image);return z.Z.getCroppedImageUrl(o,t)},D=function(n){var i=n.insightId,e=(0,S.Z)(n,T),o=t.useState(null),l=(0,s.Z)(o,2),a=l[0],u=l[1];return t.useEffect((function(){var n=!0;return E(i).then(Q).then((function(i){n&&u(i)})).catch((function(){})),function(){n=!1}}),[i]),a?(0,U.jsx)("img",(0,r.Z)({alt:"logo used in prediction",src:a},e)):null},W=e(667),$=function(n,i){var e,o=(0,r.Z)((0,r.Z)({},C.en),C[null!==e&&void 0!==e?e:(0,P.VQ)()]);return t.useEffect((function(){function e(e){var t="INPUT"===e.target.tagName.toUpperCase();if(null!==n&&void 0!==n&&n.insight_id&&!t)switch(e.key){case o.skip:i({value:y.PF,insight_id:n.insight_id});break;case o.yes:i({value:y.Q8,insight_id:n.insight_id});break;case o.no:i({value:y.hN,insight_id:n.insight_id})}}return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[null===n||void 0===n?void 0:n.insight_id,i,o.skip,o.yes,o.no]),o},B=function(n){var i=n.question,e=n.productData,o=(0,_.$G)().t,P=(0,w.n)().answerQuestions,C=(0,b.v9)(q.t$),S=(0,b.v9)(q.VO),F=(0,b.I0)(),N=t.useCallback((function(n){var i=n.insight_id,e=n.value;F((0,q.Tl)({insight_id:i,value:e})),P(e)}),[F,P]),z=(0,I.Xv)(C,i),L=(0,I.uY)(i),T=(0,p.Z)(),E=(0,j.Z)(T.breakpoints.up("md")),Q=function(n,i){var e=t.useState(null),o=(0,s.Z)(e,2),l=o[0],a=o[1];return t.useEffect((function(){if(!n.valueTag&&null!==i&&void 0!==i&&i.insight_type&&null!==i&&void 0!==i&&i.value_tag){var e=!0;return(0,I.xQ)((0,r.Z)((0,r.Z)({},n),{},{insightType:null===i||void 0===i?void 0:i.insight_type,valueTag:null===i||void 0===i?void 0:i.value_tag})).then((function(n){e&&a(n)})).catch((function(){})),function(){e=!1}}a(null)}),[n,null===i||void 0===i?void 0:i.insight_type,null===i||void 0===i?void 0:i.value_tag]),l}(C,i),B=$(i,N);return null===i?S?(0,U.jsxs)(d.Z,{sx:{width:"100%",textAlign:"center",py:10,m:0},children:[(0,U.jsx)(g.Z,{variant:"subtitle1",children:o("questions.please_wait_while_we_fetch_the_question")}),(0,U.jsx)("br",{}),(0,U.jsx)(Z.Z,{})]}):(0,U.jsxs)(v.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,U.jsx)("p",{children:o("questions.no_questions_remaining")}),(0,U.jsx)(a.Z,{size:"small",variant:"contained",onClick:function(){return F((0,q.a8)(k.wq))},children:o("questions.reset_filters")})]}):(0,U.jsxs)(v.Z,{sx:{textAlign:"center",flexGrow:1,flexBasis:0,flexShrink:1},children:[(0,U.jsxs)(v.Z,{sx:{alignItems:"center"},children:[(0,U.jsx)(g.Z,{children:null===i||void 0===i?void 0:i.question}),(0,U.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center"},children:[z?(0,U.jsx)(u.Z,{sx:{marginY:1},badgeContent:Q,color:"primary",children:(0,U.jsx)(a.Z,{sx:{paddingX:4},component:l.rU,to:z,endIcon:(0,U.jsx)(h.Z,{}),variant:"outlined",children:i.value})}):(0,U.jsx)(a.Z,{sx:{paddingX:4,marginY:1},variant:"outlined",children:i.value}),i.ref_image_url&&(0,U.jsx)("img",{alt:"logo example",src:i.ref_image_url,style:{height:"36px",marginLeft:8}})]}),L&&(0,U.jsx)(m.Z,{variant:"body2",href:L,target:"_blank",rel:"noreferrer",sx:{mb:2,display:{xs:"none",md:"inherit"}},children:(0,U.jsx)("div",{children:"".concat(o("questions.see_examples")," ").concat(i.insight_type)})})]}),(0,U.jsx)(c.Z,{}),(0,U.jsxs)(d.Z,{flexGrow:1,flexShrink:1,sx:{height:"calc(100vh - ".concat(E?461:445,"px)"),marginBottom:1,position:"relative"},children:[(0,U.jsx)(W.Z,{src:i.source_image_url||"https://static.openfoodfacts.org/images/image-placeholder.png",srcFull:(0,I.bL)(i.source_image_url),alt:"",style:{height:E?"100%":"calc(100% - 24px)",display:"inline-block"},imageProps:{style:{maxHeight:"100%",maxWidth:"100%"}}}),E?(0,U.jsx)(D,{insightId:i.insight_id,style:{position:"absolute",bottom:0,right:0,maxHeight:"75px",maxWidth:"150px"}}):(0,U.jsx)(g.Z,{sx:{position:"absolute",bottom:0},children:null===e||void 0===e?void 0:e.productName})]}),(0,U.jsxs)(v.Z,{direction:"row",justifyContent:"center",spacing:2,sx:{mb:1},children:[(0,U.jsxs)(a.Z,{onClick:function(){return N({value:y.hN,insight_id:null===i||void 0===i?void 0:i.insight_id})},color:"error",variant:"contained",size:"large",sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,U.jsx)(x.Z,{}),o("questions.no")," (",B.no,")"]}),(0,U.jsxs)(a.Z,{onClick:function(){return N({value:y.Q8,insight_id:null===i||void 0===i?void 0:i.insight_id})},startIcon:(0,U.jsx)(f.Z,{}),color:"success",variant:"contained",size:"large",sx:{display:"flex",flexDirection:"column",flexGrow:1},children:[o("questions.yes")," (",B.yes,")"]})]}),(0,U.jsxs)(a.Z,{onClick:function(){return N({value:y.PF,insight_id:null===i||void 0===i?void 0:i.insight_id})},color:"secondary",variant:"contained",size:"medium",autoFocus:!0,sx:{py:"1rem"},children:[o("questions.skip")," (",B.skip,")"]})]})},R=e(4942),G=e(9460),H=e(6070),O=e(5537),V=e(854),X=e(8408),Y=e(7951),A=e(9359),J=e(9979),K=e(2639),M=e(1731),nn=e(1526),en=e(9346),tn=e(5255),on=e(5615),rn=e(5895),sn=e(7021),ln=e(8462),an=e(7835),un=function(){var n=(0,N.Z)((0,F.Z)().mark((function n(i){var e,t,o,s,l,a,u,d,c,v,g,h,x;return(0,F.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,z.Z.insightDetail(i);case 2:if(null===(a=n.sent)||void 0===a||null===(e=a.data)||void 0===e||!e.source_image||null===a||void 0===a||null===(t=a.data)||void 0===t||null===(o=t.data)||void 0===o||!o.logo_id||null!==a&&void 0!==a&&null!==(s=a.data)&&void 0!==s&&null!==(l=s.data)&&void 0!==l&&l.bounding_box){n.next=9;break}return n.next=6,z.Z.getLogosImages([null===a||void 0===a||null===(u=a.data)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.logo_id]);case 6:return h=n.sent,x=null===h||void 0===h||null===(c=h.data)||void 0===c||null===(v=c.logos)||void 0===v||null===(g=v[0])||void 0===g?void 0:g.bounding_box,n.abrupt("return",(0,r.Z)((0,r.Z)({},a),{},{bounding_box:x}));case 9:return n.abrupt("return",a);case 10:case"end":return n.stop()}}),n)})));return function(i){return n.apply(this,arguments)}}(),dn=function(n){var i,e,o,l,a=n.insightId,u=t.useState(!0),v=(0,s.Z)(u,2),h=v[0],x=v[1],f=t.useState({}),Z=(0,s.Z)(f,2),m=Z[0],p=Z[1],j=t.useState({resume:!1,json_details:!1}),_=(0,s.Z)(j,2),b=_[0],y=_[1],k=function(n){return function(i,e){y((function(i){return(0,r.Z)((0,r.Z)({},i),{},(0,R.Z)({},n,e))}))}};t.useEffect((function(){x(!0);var n=!0;return un(a).then((function(i){n&&(x(!1),p(i))})).catch((function(i){n&&(x(!1),p(i))})),function(){n=!1}}),[a]);var q=function(n){var i,e=null===n||void 0===n?void 0:n.data,t=(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.bounding_box)||(null===n||void 0===n?void 0:n.bounding_box);if(null===e||void 0===e||!e.source_image||!t)return null;var o=L.Z.getImageUrl(null===e||void 0===e?void 0:e.source_image);return z.Z.getCroppedImageUrl(o,t)}(m);return(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(c.Z,{sx:{mt:2}}),(0,U.jsxs)(d.Z,{sx:{px:2,my:2},children:[(0,U.jsxs)(on.Z,{variant:"outlined",onChange:k("resume"),expanded:b.resume,children:[(0,U.jsx)(rn.Z,{expandIcon:(0,U.jsx)(ln.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,U.jsx)(g.Z,{children:"resume"})}),(0,U.jsx)(sn.Z,{children:h?(0,U.jsx)(an.Z,{}):(0,U.jsxs)("div",{children:[(0,U.jsx)(Y.Z,{size:"small",children:(0,U.jsxs)(A.Z,{sx:{" td, th":{border:"none"},th:{verticalAlign:"top",pr:0}},children:[(0,U.jsxs)(K.Z,{children:[(0,U.jsx)(J.Z,{component:"th",scope:"row",children:"insight id"}),(0,U.jsx)(J.Z,{children:null===m||void 0===m||null===(i=m.data)||void 0===i?void 0:i.id})]}),(0,U.jsxs)(K.Z,{children:[(0,U.jsx)(J.Z,{component:"th",scope:"row",children:"generator model"}),(0,U.jsx)(J.Z,{children:null===m||void 0===m||null===(e=m.data)||void 0===e?void 0:e.predictor})]}),(0,U.jsxs)(K.Z,{children:[(0,U.jsx)(J.Z,{component:"th",scope:"row",children:"timestamp"}),(0,U.jsx)(J.Z,{children:new Date(null===m||void 0===m||null===(o=m.data)||void 0===o?void 0:o.timestamp).toLocaleString()})]})]})}),q&&(0,U.jsx)("img",{alt:"lroUsed for prediction",src:q,style:{maxHeight:"150px"}})]})})]}),(0,U.jsxs)(on.Z,{variant:"outlined",onChange:k("json_details"),expanded:b.json_details,children:[(0,U.jsx)(rn.Z,{expandIcon:(0,U.jsx)(ln.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,U.jsx)(g.Z,{children:"raw JSON"})}),(0,U.jsx)(sn.Z,{children:h?(0,U.jsx)(an.Z,{}):(0,U.jsx)(g.Z,{variant:"caption",component:"pre",children:JSON.stringify(null!==(l=null===m||void 0===m?void 0:m.data)&&void 0!==l?l:m,null,2)})})]})]})]})},cn=e(5886),vn=function(n){var i=n.question,e=n.productData,o=(0,_.$G)().t,l=(0,P.xn)(),u=t.useState(P.B2),h=(0,s.Z)(u,2),x=h[0],f=h[1],Z=t.useState((function(){return(0,P.l7)().questionPage})),p=(0,s.Z)(Z,1)[0],j=(0,I.PR)(null===i||void 0===i?void 0:i.barcode),b=(0,s.Z)(j,3),k=b[0],q=b[1],w=b[2],C=(0,I.cb)(null===i||void 0===i?void 0:i.barcode,null===i||void 0===i?void 0:i.insight_id),S=(0,s.Z)(C,4),F=S[0],N=S[1],T=S[2],E=S[3];if(!i||i.insight_id===y.Fl)return null;var Q=function(n){if(Boolean(n)){for(var i=n.split(", "),e="",t=0;t<i.length;t++)e+=(0,cn.VS)(i[t]),t!==i.length-1&&(e+=", ");return e}};return(0,U.jsxs)(d.Z,{children:[(0,U.jsx)(g.Z,{children:null===e||void 0===e?void 0:e.productName}),(0,U.jsx)(a.Z,{size:"small",component:m.Z,target:"_blank",href:L.Z.getProductUrl(i.barcode),variant:"outlined",startIcon:(0,U.jsx)(X.Z,{}),sx:{minWidth:150},children:o("questions.view")}),(0,U.jsx)(a.Z,{size:"small",component:m.Z,target:"_blank",href:L.Z.getProductEditUrl(i.barcode),variant:"contained",startIcon:(0,U.jsx)(V.Z,{}),sx:{ml:2,minWidth:150},children:o("questions.edit")}),l&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(c.Z,{sx:{my:1}}),(0,U.jsx)(g.Z,{variant:"h5",children:o("questions.other_questions")}),F.isLoading?null:F.questions.map((function(n){return(0,U.jsxs)(v.Z,{direction:"row",sx:{mt:1,alignItems:"flex-start"},children:[(0,U.jsxs)(g.Z,{children:[null===n||void 0===n?void 0:n.question," (",null===n||void 0===n?void 0:n.value,")"]},n.insight_id),(0,U.jsx)(a.Z,{onClick:function(){E((function(i){return(0,r.Z)((0,r.Z)({},i),{},(0,R.Z)({},null===n||void 0===n?void 0:n.insight_id,i[null===n||void 0===n?void 0:n.insight_id]===y.Q8?y.PF:y.Q8))}))},color:"success",variant:T[null===n||void 0===n?void 0:n.insight_id]===y.Q8?"contained":"outlined",size:"small",sx:{ml:1},children:o("questions.yes")}),(0,U.jsx)(a.Z,{onClick:function(){E((function(i){return(0,r.Z)((0,r.Z)({},i),{},(0,R.Z)({},null===n||void 0===n?void 0:n.insight_id,i[null===n||void 0===n?void 0:n.insight_id]===y.hN?y.PF:y.hN))}))},color:"error",variant:T[null===n||void 0===n?void 0:n.insight_id]===y.hN?"contained":"outlined",size:"small",children:o("questions.no")}),(0,U.jsx)(a.Z,{onClick:function(){var i=T[null===n||void 0===n?void 0:n.insight_id];i!==y.Q8&&i!==y.hN&&i!==y.PF||(z.Z.annotate(null===n||void 0===n?void 0:n.insight_id,i),N((function(i){return(0,r.Z)((0,r.Z)({},i),{},{questions:i.questions.filter((function(i){return(null===i||void 0===i?void 0:i.insight_id)!==(null===n||void 0===n?void 0:n.insight_id)}))})}))),E((function(i){return(0,r.Z)((0,r.Z)({},i),{},(0,R.Z)({},null===n||void 0===n?void 0:n.insight_id,y.hN))}))},color:"secondary",disabled:![y.Q8,y.hN].includes(T[null===n||void 0===n?void 0:n.insight_id]),variant:"contained",size:"small",sx:{ml:1},children:o("questions.send")})]},n.insight_id)}))]}),(0,U.jsx)(c.Z,{sx:{my:1}}),(0,U.jsx)(H.Z,{control:(0,U.jsx)(G.Z,{checked:x,onChange:function(n){f(n.target.checked),P.KT.update(P.X7.hideImages,n.target.checked)}}),label:o("questions.hide_images"),labelPlacement:"end"}),!x&&(null===e||void 0===e?void 0:e.images)&&(0,U.jsx)(O.ZP,{container:!0,rowSpacing:1.5,spacing:1,children:(0,I.Rd)(e.images,i.barcode).map((function(n){return(0,U.jsxs)(O.ZP,{item:!0,style:{display:"inline-flex",alignItems:"flex-start"},children:[(0,U.jsx)(W.Z,{src:n,imageProps:{loading:"lazy",style:{maxWidth:300,maxHeight:300}}}),k.includes((0,I.V0)(n))?(0,U.jsx)(tn.Z,{title:o("questions.unflag"),children:(0,U.jsx)(en.Z,{onClick:function(){return w(n,i.barcode)},children:(0,U.jsx)(nn.Z,{})})}):(0,U.jsx)(tn.Z,{title:o("questions.flag"),children:(0,U.jsx)(en.Z,{onClick:function(){return q(n,i.barcode)},children:(0,U.jsx)(M.Z,{})})})]},n)}))}),(0,U.jsx)(c.Z,{}),(0,U.jsx)(Y.Z,{size:"small",children:(0,U.jsx)(A.Z,{sx:{" td, th":{border:"none"},th:{verticalAlign:"top",pr:0}},children:Object.keys(I._l).map((function(n){return(0,U.jsxs)(K.Z,{children:[(0,U.jsx)(J.Z,{component:"th",scope:"row",children:o("questions.".concat(I._l[n]))}),"countriesTags"!==n?(0,U.jsx)(J.Z,{children:null===e||void 0===e?void 0:e[n]}):(0,U.jsx)(J.Z,{children:Q(null===e||void 0===e?void 0:e[n])})]},n)}))})}),l&&p.showDebug&&(0,U.jsx)(dn,{insightId:i.insight_id}),(0,U.jsx)(c.Z,{})]})},gn=e(8386),hn=e(9762),xn=e(9830),fn=e(2054),Zn=e(2541),mn=e(1394),pn=e(2034),jn=e(9143),_n=e(6958),bn=function(){var n=(0,_.$G)().t,i=(0,b.v9)(q.b0),e=(0,b.v9)(q.HR),o=t.useState(!1),r=(0,s.Z)(o,2),l=r[0],u=r[1],c=t.useState(!1),h=(0,s.Z)(c,2),x=h[0],f=h[1],Z=t.useContext(_n.Z).isLoggedIn;t.useEffect((function(){e.length>3&&!Z&&!l&&f(!0)}),[e.length,Z,l]);var p=e.filter((function(n){return-1!==n.validationValue}));return p=p.slice(Math.max(0,p.length-30),p.length),(0,U.jsxs)(d.Z,{children:[(0,U.jsxs)(v.Z,{spacing:1,children:[(0,U.jsxs)(g.Z,{sx:{my:2},children:[n("questions.remaining_annotations"),": ",i]}),p.map((function(n){var i=n.insight_id,e=n.barcode,t=n.value,o=n.insight_type,r=n.validationValue,s=n.isPending;return(0,U.jsxs)(v.Z,{direction:"row",alignItems:"center",children:[s&&(0,U.jsx)(en.Z,{size:"small",sx:{mr:1},children:(0,U.jsx)(jn.Z,{fontSize:"inherit"})}),(0,U.jsxs)(m.Z,{href:L.Z.getProductEditUrl(e),children:[o,": ",t]}),r===y.hN&&(0,U.jsx)(mn.Z,{color:"error",sx:{ml:2}}),r===y.Q8&&(0,U.jsx)(pn.Z,{color:"success",sx:{ml:2}})]},i)}))]}),(0,U.jsxs)(gn.Z,{open:x,onClose:function(){f(!1),u(!0)},children:[(0,U.jsx)(hn.Z,{children:n("questions.login_title")}),(0,U.jsx)(xn.Z,{children:(0,U.jsx)(fn.Z,{children:n("questions.login_description")})}),(0,U.jsxs)(Zn.Z,{children:[(0,U.jsx)(a.Z,{variant:"contained",href:"https://world.openfoodfacts.org/cgi/login.pl",component:m.Z,target:"_blank",children:n("questions.log_in")}),(0,U.jsx)(a.Z,{variant:"contained",href:"https://world.openfoodfacts.org/cgi/user.pl",component:m.Z,target:"_blank",children:n("questions.sign_up")})]})]})]})};function yn(){var n=(0,b.I0)(),i=(0,b.v9)(q.UB),e=(0,b.v9)(q.s_),r=(0,b.v9)(q.rc);t.useEffect((function(){i<5&&n((0,q.Oz)())}),[n,i,e]);var s=(0,b.v9)(q.$Y),l=(0,I.d2)(null===s||void 0===s?void 0:s.barcode);return(0,U.jsxs)(O.ZP,{container:!0,spacing:2,p:2,children:[(0,U.jsx)(O.ZP,{item:!0,xs:12,md:5,children:(0,U.jsxs)(v.Z,{direction:"column",sx:{height:{xs:"calc(100vh - 76px)",md:"calc(100vh - 110px)"}},children:[(0,U.jsx)(o.Z,{}),(0,U.jsx)(c.Z,{sx:{margin:"1rem"}}),(0,U.jsx)(B,{question:s,productData:l})]})}),(0,U.jsx)(O.ZP,{item:!0,xs:12,md:5,children:(0,U.jsx)(vn,{question:s,productData:l})}),(0,U.jsx)(O.ZP,{item:!0,xs:12,md:2,children:(0,U.jsx)(bn,{})}),r.map((function(n){return(0,U.jsx)("link",{rel:"prefetch",href:n},n)}))]})}function kn(){return(0,U.jsx)(t.Suspense,{fallback:(0,U.jsx)(Z.Z,{}),children:(0,U.jsx)(b.zt,{store:q.ZP,children:(0,U.jsx)(yn,{})})})}},5726:function(n,i,e){e.d(i,{PR:function(){return p},Rd:function(){return Z},V0:function(){return f},Xv:function(){return b},_l:function(){return x},bL:function(){return _},cb:function(){return m},d2:function(){return j},uY:function(){return y},xQ:function(){return k}});var t=e(4165),o=e(5861),r=e(1413),s=e(3433),l=e(9439),a=e(9867),u=e(9025),d=e(5886),c=e(3449),v=e(3547),g=e(3768),h=e(5244),x={brands:"brands",ingredientsText:"ingredients",countriesTags:"countries",categories:"categories",labels_tags:"labels",quantity:"quantity"},f=function(n){var i=n.split("/").at(-1).replace(/\..+$/,"");return Number(i)},Z=function(n,i){if(!n||!i)return[];var e=v.Z.getFormatedBarcode(i),t=v.Z.getImageUrl(e);return Object.keys(n).filter((function(n){return!isNaN(Number.parseInt(n))})).map((function(n){return"".concat(t,"/").concat(n,".jpg")}))},m=function(n,i){var e=a.useState({questions:[],isLoading:!0}),t=(0,l.Z)(e,2),o=t[0],r=t[1];a.useEffect((function(){if(n){var e=!0;return r({questions:[],isLoading:!0}),g.Z.questionsByProductCode(n).then((function(n){var t,o;if(e){var s=null!==(t=null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.questions)&&void 0!==t?t:[];r({questions:s.filter((function(n){return(null===n||void 0===n?void 0:n.insight_id)!==i})),isLoading:!1})}})),function(){e=!1}}}),[n,i]);var s=a.useState({}),u=(0,l.Z)(s,2),d=u[0],c=u[1];return[o,r,d,c]},p=function(n){var i=a.useState([]),e=(0,l.Z)(i,2),t=e[0],o=e[1],r=a.useCallback((function(i){var e=f(i);c.ZP.addImageFlag({barcode:n,imgid:e,url:i}),o((function(n){return[].concat((0,s.Z)(n),[e])}))}),[n]),u=a.useCallback((function(i){var e=f(i);c.ZP.removeImageFlag({barcode:n,imgid:e}),o((function(n){return n.filter((function(n){return n!==e}))}))}),[n]);return a.useEffect((function(){o([])}),[n]),[t,r,u]},j=function(n){var i=a.useState({}),e=(0,l.Z)(i,2),t=e[0],o=e[1];return a.useEffect((function(){if(n){var i=!0;return o({code:n,isLoading:!0}),v.Z.getProduct(n).then((function(e){var t,r,s,l;if(i){var a=e.data.product;o({code:n,productName:(null===a||void 0===a?void 0:a.product_name)||"",brands:(null===a||void 0===a?void 0:a.brands)||"?",ingredientsText:(null===a||void 0===a?void 0:a.ingredients_text)||"?",countriesTags:null!==a&&void 0!==a&&a.countries_tags?"".concat(null===a||void 0===a||null===(t=a.countries_tags)||void 0===t||null===(r=t.join)||void 0===r?void 0:r.call(t,", "),"."):"?",images:(null===a||void 0===a?void 0:a.images)||{},categories:(null===a||void 0===a?void 0:a.categories)||"?",labels_tags:(null===a||void 0===a||null===(s=a.labels_tags)||void 0===s||null===(l=s.join)||void 0===l?void 0:l.call(s,", "))||"?",quantity:(null===a||void 0===a?void 0:a.quantity)||"?",isLoading:!1})}})).catch((function(){})),function(){i=!1}}}),[n]),t},_=function(n){return n?/\/[a-z_]+.[0-9]*.400.jpg$/gm.test(n)?n.replace("400.jpg","full.jpg"):n.replace("400.jpg","jpg"):"https://static.openfoodfacts.org/images/image-placeholder.png"},b=function(n,i){if(null!==i&&i&&(null===i||void 0===i?void 0:i.insight_id)!==u.Fl&&null!==i&&void 0!==i&&i.value_tag){var e=new URLSearchParams;return e.append("type",i.insight_type),e.append("value_tag",(0,d.Ii)(null===i||void 0===i?void 0:i.value_tag)),"/questions?".concat((0,h.P)((0,r.Z)((0,r.Z)({},n),{},{insightType:i.insight_type,valueTag:null===i||void 0===i?void 0:i.value_tag})))}return null},y=function(n){return null!==n&&(null===n||void 0===n?void 0:n.insight_id)!==u.Fl&&null!==n&&void 0!==n&&n.value_tag&&n.insight_type?"".concat(u.HD,"/").concat(n.insight_type,"/").concat((0,d.Ii)(null===n||void 0===n?void 0:n.value_tag)):""},k=function(){var n=(0,o.Z)((0,t.Z)().mark((function n(i){var e,o;return(0,t.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.Z.questions(i,1);case 2:return e=n.sent,o=e.data,n.abrupt("return",o.count);case 5:case"end":return n.stop()}}),n)})));return function(i){return n.apply(this,arguments)}}()}}]);
//# sourceMappingURL=713.85a70955.chunk.js.map