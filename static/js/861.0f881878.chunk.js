"use strict";(self.webpackChunkhunger_game=self.webpackChunkhunger_game||[]).push([[861],{9524:function(n,e,t){var o=t(1413),a=t(5987),i=t(4165),r=t(5861),c=t(9439),u=t(9867),l=t(3248),s=t(3865),d=t(3911),g=t(829),f=t(2418),p=t(9421),v=t(2834),h=["value","type","updateMode","request","isLoading"],m=["packager_code","qr_code","no_logo"],y=[{value:"",labelKey:"logos.type"},{value:"label",labelKey:"logos.label"},{value:"brand",labelKey:"logos.brand"},{value:"packager_code",labelKey:"logos.packager_code"},{value:"packaging",labelKey:"logos.packaging"},{value:"qr_code",labelKey:"logos.qr_code"},{value:"category",labelKey:"logos.category"},{value:"nutrition_label",labelKey:"logos.nutrition_label"},{value:"store",labelKey:"logos.store"},{value:"no_logo",labelKey:"logos.no_logo"}],x=function(n){var e=n.type,t=n.value;return 0!==e.length&&!(!t&&!m.includes(e))},Z=function(n){var e=n.type,t=n.value;if(!x({type:e,value:t}))return null;var o=t.toLowerCase().trim();return m.includes(e)&&(o=""),{type:e,value:o}};e.Z=function(n){var e=n.value,t=n.type,b=n.updateMode,w=n.request,j=n.isLoading,_=(0,a.Z)(n,h),C=(0,f.$G)().t,S=function(n,e,t){var o=u.useState(!1),a=(0,c.Z)(o,2),l=a[0],s=a[1],d=u.useState(n),g=(0,c.Z)(d,2),f=g[0],p=g[1],v=u.useState(e),h=(0,c.Z)(v,2),y=h[0],b=h[1];u.useLayoutEffect((function(){p(n)}),[n]),u.useLayoutEffect((function(){b(e)}),[e]);var w=u.useCallback((0,r.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(!0),n.next=3,t(Z({type:y,value:f}));case 3:s(!1);case 4:case"end":return n.stop()}}),n)}))),[t,y,f]),j=y!==e||!m.includes(y)&&(null!==f?f.toLowerCase()!==n.toLowerCase():f!==n),_=x({type:y||"",value:f}),C=["label","category","packaging"].includes(y);return{isSending:l,send:w,isDifferent:j,hasAutoComplet:C,isValid:_,typeControl:{value:y,onChange:function(n){return b(n.target.value)}},valueControl:{insightType:C?y:void 0,value:f,onChange:C?function(n){return p(n)}:function(n){return p(n.target.value)}}}}(e,t,w),k=S.isSending,K=S.send,E=S.isDifferent,L=S.isValid,O=S.hasAutoComplet,z=S.typeControl,q=S.valueControl;return(0,v.jsxs)(l.Z,(0,o.Z)((0,o.Z)({direction:{xs:"column",md:"row"},spacing:{xs:1,sm:2,md:4}},_),{},{children:[(0,v.jsx)(s.Z,(0,o.Z)((0,o.Z)({},z),{},{select:!0,label:C("logos.type"),sx:{minWidth:{xs:"80%",sm:350}},size:"small",children:y.map((function(n){var e=n.value,t=n.labelKey;return(0,v.jsx)(d.Z,{value:e,children:C(t)},t)}))})),O?(0,v.jsx)(p.Z,(0,o.Z)((0,o.Z)({showKey:!0},q),{},{label:C("logos.value"),size:"small",sx:{minWidth:{xs:"80%",sm:350}}})):(0,v.jsx)(s.Z,(0,o.Z)((0,o.Z)({},q),{},{label:C("logos.value"),sx:{minWidth:{xs:"80%",sm:350}},size:"small"})),(0,v.jsx)(g.Z,{onClick:K,loading:k,disabled:j||!L||b&&!E,variant:"contained",color:"primary",children:C("logos.update")})]}))}},6311:function(n,e,t){var o=t(1413),a=t(4165),i=t(5861),r=t(9439),c=t(9867),u=t(4828),l=t(5226),s=t(9801),d=t(8345),g=t(7298),f=t(8547),p=t(9346),v=t(5255),h=t(9460),m=t(5644),y=t(2418),x=t(854),Z=t(8430),b=t(8684),w=t(9524),j=t(9025),_=t(3768),C=t(2834),S=function(n){return"/logos?logo_id=".concat(n,"&count=50")},k=c.memo((function(n){var e=n.selected,t=n.id,o=n.index,k=n.selectionApiRef,K=n.annotation_value,E=n.image,L=n.annotation_type,O=n.distance,z=n.readOnly,q=n.editOpen,B=(0,y.$G)().t,N=(0,b.Z)(),R=c.useState(q),T=(0,r.Z)(R,2),V=T[0],I=T[1],U=c.useCallback(function(){var n=(0,i.Z)((0,a.Z)().mark((function n(e){var o,i;return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!=e){n.next=2;break}return n.abrupt("return");case 2:if(o=e.type,i=e.value,j.rp){n.next=6;break}return n.next=6,_.Z.updateLogo(t,i,o);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[t]),A=function(n){var a,i,r,c;n.shiftKey?null===(a=(i=k.current).rangeSelection)||void 0===a||a.call(i,o,t,e):null===(r=(c=k.current).singleSelection)||void 0===r||r.call(c,o,t,e)};return(0,C.jsxs)(u.Z,{sx:{width:180,margin:"20px auto 0 auto",boxSizing:"border-box",backgroundColor:e?N.palette.action.selected:L?N.palette.action.disabledBackground:void 0,position:"relative"},children:[(0,C.jsxs)(g.Z,{sx:{display:"flex",justifyContent:"space-between",padding:1},children:[(0,C.jsx)(v.Z,{title:"Edit this logo",children:(0,C.jsx)(p.Z,{size:"small",onClick:function(){I((function(n){return!n}))},children:(0,C.jsx)(x.Z,{fontSize:"inherit"})})}),(0,C.jsx)(v.Z,{title:"See similar logos",children:(0,C.jsx)(p.Z,{size:"small",component:m.rU,to:S(t),children:(0,C.jsx)(Z.Z,{fontSize:"inherit"})})})]}),(0,C.jsx)(l.Z,{}),(0,C.jsx)(s.Z,{disabled:z||!!L,onClick:A,sx:{flexGrow:1},children:(0,C.jsx)(d.Z,{component:"img",height:"150px",width:"180px",loading:"lazy",image:E,sx:{objectFit:"contain"}})}),(0,C.jsx)(f.Z,{sx:{padding:1},variant:"caption",children:void 0!==O&&"".concat(B("logos.distance")," ").concat(O.toFixed(1))}),(0,C.jsx)("br",{}),q||V?(0,C.jsx)(w.Z,{value:K,type:L,updateMode:!0,request:U,sx:{"&":{flexDirection:"column"},"& .MuiTextField-root, & .MuiButtonBase-root, & .MuiAutocomplete-root":{minWidth:0,width:"100%",margin:0}}}):(0,C.jsx)(f.Z,{sx:{padding:1},variant:"caption",children:(L||K)&&"".concat(B("logos.annotation")," ").concat(K||""," (").concat(L||"",")")}),!z&&(0,C.jsx)(h.Z,{checked:e,disabled:!!L,size:"small",onClick:A,sx:{position:"absolute",bottom:0,right:0}})]})}));e.Z=function(n){var e=n.logos,t=n.toggleLogoSelection,a=n.setLogoSelectionRange,i=n.readOnly,u=n.sx,l=n.editOpen,s=c.useState(null),d=(0,r.Z)(s,2),f=d[0],p=d[1],v=c.useRef({}),h=c.useState([]),m=(0,r.Z)(h,2),y=m[0],x=m[1];return c.useEffect((function(){JSON.stringify(y)!==JSON.stringify(e.map((function(n){return n.id})))&&(x(e.map((function(n){return n.id}))),p(null))}),[y,e]),c.useEffect((function(){v.current={rangeSelection:function(n,e,o){if(void 0!==a){null===f&&(t(e),p({selected:!o,index:n}));var i=o===f.selected?!f.selected:f.selected,r=Math.min(n,f.index),c=Math.max(n,f.index);a(y.slice(r,c+1),i),p({selected:i,index:n})}else t(e)},singleSelection:function(n,e,o){t(e),void 0!==a&&p((function(e){return{selected:!o,index:n}}))}}}),[f,y,a,t]),(0,C.jsx)(g.Z,{sx:(0,o.Z)({paddingTop:5,display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",alignItems:"center",justifyContent:"center"},u),children:e.map((function(n,e){return(0,C.jsx)(k,{index:e,selected:n.selected||!1,id:n.id,annotation_value:n.annotation_value,image:n.image.src,annotation_type:n.annotation_type,distance:n.distance,readOnly:i,selectionApiRef:v,editOpen:l},n.id)}))})}},9421:function(n,e,t){var o=t(5987),a=t(1413),i=t(3433),r=t(9439),c=t(9867),u=t(2915),l=t(3865),s=t(3843),d=t(8025),g=t.n(d),f=t(9025),p=t(2834),v=["showKey","onChange","value","insightType","fullWidth"],h=["de","es","fr","hr","nl","sv"],m=function(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^0-9a-z]/gi," ")};e.Z=function(n){var e=n.showKey,t=n.onChange,d=n.value,y=n.insightType,x=n.fullWidth,Z=(0,o.Z)(n,v),b=c.useState(null),w=(0,r.Z)(b,2),j=w[0],_=w[1],C=c.useState(""),S=(0,r.Z)(C,2),k=S[0],K=S[1],E=(0,s.VQ)(),L=function(n,e,t){var o=c.useState([]),u=(0,r.Z)(o,2),l=u[0],s=u[1],d=c.useRef({});return c.useEffect((function(){s([]),d.current={}}),[n]),c.useEffect((function(){var o=e.toLowerCase();/^[a-z][a-z]:/.test(o)&&(o=o.slice(3)),[(o=o.replace(/[^0-9a-z]/gi,"-")).slice(0,1),o.slice(0,2),o.slice(0,3)].forEach((function(e){e.length>0&&!d.current[e]&&(d.current[e]=!0,g().get("".concat(f.pV,"/data/").concat(h.includes(t)?t:"en","/").concat(n,"/").concat(e,".json")).then((function(n){var e=n.data;s((function(n){var t=n.map((function(n){return n.key}));return[].concat((0,i.Z)(n),(0,i.Z)(e.filter((function(n){var e=n.key;return!t.includes(e)})).map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{cleanName:m(n.name)})}))))}))})).catch((function(){})))}))}),[e,n,t]),l}(y,k,E);return c.useEffect((function(){_((function(n){if("object"===typeof n&&(null===n||void 0===n?void 0:n.key)===d)return n;var e=L.find((function(n){return n.key===d}));return e||d}))}),[d,L]),(0,p.jsx)(u.Z,{fullWidth:x,freeSolo:!0,onChange:function(n,e){var o;_(e),t(null!==(o=null===e||void 0===e?void 0:e.key)&&void 0!==o?o:e)},onInputChange:function(n,e,t){K(e)},onBlur:function(){("string"===typeof j?j===k:j.name===k)||(_(k),t(k))},inputValue:k,value:j,options:L,getOptionLabel:function(n){var e;return null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:n},renderInput:function(n){return(0,p.jsx)(l.Z,(0,a.Z)((0,a.Z)((0,a.Z)({},n),Z),{},{helperText:e&&((null===j||void 0===j?void 0:j.key)||""!==j&&null!==j&&'\u26a0\ufe0f unknown: "'.concat(j,'"'))}))},filterOptions:function(n,e){return n.filter((function(n){return null===n||void 0===n?void 0:n.cleanName.includes(m(e.inputValue))}))}})}},2068:function(n,e,t){t.d(e,{aR:function(){return u}});var o=t(9439),a=t(1413),i=t(9867),r=t(4670),c=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,a.Z)({},n),i=new URLSearchParams(window.location.search);return Object.keys(n).forEach((function(e){var o=i.get(e);null!==o&&JSON.stringify(n[e])!==o&&(t[e]="true"===o||"false"===o?JSON.parse(o):o)})),Object.entries(e).forEach((function(e){var a=(0,o.Z)(e,2),r=a[0],c=a[1];("string"===typeof c?[c]:c).forEach((function(e){var o=i.get(e);null!==o&&JSON.stringify(n[r])!==o&&(t[r]="true"===o||"false"===o?JSON.parse(o):o)}))})),t},u=function(n,e){var t=new URLSearchParams(window.location.search);return Object.keys(n).forEach((function(e){JSON.stringify(n[e])!==t.get(e)&&t.set(e,n[e])})),void 0!==e&&Object.keys(e).forEach((function(o){null!==t.get(o)&&e[o]===n[o]&&t.delete(o)})),t.toString()};e.ZP=function(n,e){var t=i.useState((function(){return c(n)})),a=(0,o.Z)(t,2),l=a[0],s=a[1],d=(0,r.TH)().search;i.useEffect((function(){s((function(t){var o=c(n,e);return Object.keys(n).some((function(n){return o[n]!==t[n]}))?o:t}))}),[d,n,e]);var g=i.useCallback((function(e){var t;t="function"===typeof e?e(l):e,s(t),function(n,e){var t="".concat(window.location.pathname,"?").concat(u(n,e));window.history.pushState(null,"",t)}(t,n)}),[l,n]);return[l,g]}},3768:function(n,e,t){var o=t(9439),a=t(1413),i=t(8025),r=t.n(i),c=t(9025),u=t(3843),l=t(5886),s={annotate:function(n,e){if(!c.rp)return r().post("".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(n,"&annotation=").concat(e,"&update=1")),{withCredentials:!0});console.log("Annotated, ".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(n,"&annotation=").concat(e,"&update=1")),{withCredentials:!0})},questionsByProductCode:function(n){return r().get("".concat(c.oK,"/questions/").concat(n)).then((function(n){var e=n.data.questions;return n.data.questions=e.filter((function(n){return n.source_image_url})),n}))},questions:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=n.insightType,i=n.brandFilter,s=n.valueTag,d=n.countryFilter,g=n.sortByPopularity,f=n.campaign,p=n.predictor,v={insight_types:o,value_tag:s,brands:(0,l.Ii)(i),country:"en:world"!==d?d:null,campaign:f,predictor:p},h=(0,u.VQ)();return r().get("".concat(c.oK,"/questions/").concat(g?"popular":"random"),{params:(0,l.BE)((0,a.Z)((0,a.Z)({},v),{},{lang:h,count:e,page:t}))})},insightDetail:function(n){return r().get("".concat(c.oK,"/insights/detail/").concat(n))},loadLogo:function(n){return r().get("".concat(c.oK,"/images/logos/").concat(n))},updateLogo:function(n,e,t){return r().put("".concat(c.oK,"/images/logos/").concat(n),(0,l.BE)({value:e,type:t}),{withCredentials:!0})},searchLogos:function(n,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=["label","category"].includes(t)?{taxonomy_value:e}:{value:e};return r().get("".concat(c.oK,"/images/logos/search/"),{params:(0,l.BE)((0,a.Z)({barcode:n,type:t,count:o,random:i},u))})},getLogoAnnotations:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=n.length>0?"".concat(c.oK,"/ann/search/").concat(n):"".concat(c.oK,"/ann/search");return r().get(o,{params:(0,l.BE)({index:e,count:t})})},annotateLogos:function(n){return r().post("".concat(c.oK,"/images/logos/annotate"),(0,l.BE)({annotations:n}),{withCredentials:!0})},getInsights:function(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:25;return a.length&&"not_annotated"===a&&(n="0",a=""),r().get("".concat(c.oK,"/insights"),{params:(0,l.BE)({barcode:e,insight_types:t,value_tag:o,annotation:a,page:i,annotated:n,count:u})})},getUserStatistics:function(n){return r().get("".concat(c.oK,"/users/statistics/").concat(n))},getCroppedImageUrl:function(n,e){var t=(0,o.Z)(e,4),a=t[0],i=t[1],r=t[2],u=t[3];return"".concat(c.oK,"/images/crop?image_url=").concat(n,"&y_min=").concat(a,"&x_min=").concat(i,"&y_max=").concat(r,"&x_max=").concat(u)},getLogosImages:function(n){return r().get("".concat(c.oK,"/images/logos?logo_ids=").concat(n.join(",")))},getNutritionValueFromImage:function(n,e,t){var o=e.split("/"),a=o[5],i="nutrition_".concat(n);for(var u in t)if(i===u)var l=t[i].imgid;return o.length>7&&(a=o[5]+"/"+o[6]+"/"+o[7]+"/"+o[8]),r().get("".concat(c.oK,"/predict/nutrient?ocr_url=https://images.openfoodfacts.org/images/products/").concat(a,"/").concat(l,".json"))},getUnansweredValues:function(n){var e,t=null!==(e=n.page)&&void 0!==e?e:1;return t=t>=1?t:1,r().get("".concat(c.oK,"/questions/unanswered/?").concat(Object.keys((0,a.Z)((0,a.Z)({},n),{},{page:t})).filter((function(e){return void 0!==n[e]})).map((function(e){return"".concat(e,"=").concat(n[e])})).join("&")))}};e.Z=s},5886:function(n,e,t){t.d(e,{BE:function(){return r},Ii:function(){return i},VS:function(){return u},_v:function(){return c}});var o=t(9439),a={" ":"-","'":"-","&":"","\xe0":"a","\xe2":"a","\xe4":"a","\xe9":"e","\xe8":"e","\xea":"e","\xeb":"e","\xee":"i","\xef":"i","\xf4":"o","\xf6":"o","\xfb":"u","\xf9":"u","\xfc":"u"},i=function(n){if(!n)return n;for(var e=n.trim().toLowerCase(),t=0,i=Object.entries(a);t<i.length;t++){var r=(0,o.Z)(i[t],2),c=r[0],u=r[1];e=e.replace(new RegExp(c,"g"),u)}return e=e.replace(/-{2,}/g,"-")},r=function(n){return Object.keys(n).forEach((function(e){return(null==n[e]||""===n[e])&&delete n[e]})),n};function c(n){return new Promise((function(e){return setTimeout(e,n)}))}var u=function(n){if(!n)return n;var e=n.slice(3);return e.charAt(0).toUpperCase()+e.slice(1)}}}]);
//# sourceMappingURL=861.0f881878.chunk.js.map