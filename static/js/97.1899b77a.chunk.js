"use strict";(self.webpackChunkhunger_game=self.webpackChunkhunger_game||[]).push([[97],{2068:function(t,e,n){n.d(e,{aR:function(){return l}});var a=n(9439),i=n(1413),o=n(9867),r=n(4670),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,i.Z)({},t),o=new URLSearchParams(window.location.search);return Object.keys(t).forEach((function(e){var a=o.get(e);null!==a&&JSON.stringify(t[e])!==a&&(n[e]="true"===a||"false"===a?JSON.parse(a):a)})),Object.entries(e).forEach((function(e){var i=(0,a.Z)(e,2),r=i[0],c=i[1];("string"===typeof c?[c]:c).forEach((function(e){var a=o.get(e);null!==a&&JSON.stringify(t[r])!==a&&(n[r]="true"===a||"false"===a?JSON.parse(a):a)}))})),n},l=function(t,e){var n=new URLSearchParams(window.location.search);return Object.keys(t).forEach((function(e){JSON.stringify(t[e])!==n.get(e)&&n.set(e,t[e])})),void 0!==e&&Object.keys(e).forEach((function(a){null!==n.get(a)&&e[a]===t[a]&&n.delete(a)})),n.toString()};e.ZP=function(t,e){var n=o.useState((function(){return c(t)})),i=(0,a.Z)(n,2),u=i[0],s=i[1],g=(0,r.TH)().search;o.useEffect((function(){s((function(n){var a=c(t,e);return Object.keys(t).some((function(t){return a[t]!==n[t]}))?a:n}))}),[g,t,e]);var d=o.useCallback((function(e){var n;n="function"===typeof e?e(u):e,s(n),function(t,e){var n="".concat(window.location.pathname,"?").concat(l(t,e));window.history.pushState(null,"",n)}(n,t)}),[u,t]);return[u,d]}},7097:function(t,e,n){n.r(e),n.d(e,{default:function(){return V}});var a=n(9439),i=n(8514),o=n(3248),r=n(5226),c=n(9867),l=n(8547),u=n(3865),s=n(3911),g=n(4964),d=n(2418),h=n(2834),f=[{value:"",labelKey:"insights.all"},{value:"label",labelKey:"insights.label"},{value:"product_weight",labelKey:"insights.product_weight"},{value:"category",labelKey:"insights.category"},{value:"expiration_date",labelKey:"insights.expiration_date"},{value:"packager_code",labelKey:"insights.packager_code"},{value:"brand",labelKey:"logos.brand"},{value:"packaging",labelKey:"logos.packaging"},{value:"qr_code",labelKey:"logos.qr_code"}],v=[{value:"",labelKey:"insights.all"},{value:"-1",labelKey:"insights.skipped"},{value:"0",labelKey:"insights.rejected"},{value:"1",labelKey:"insights.accepted"},{value:"not_annotated",labelKey:"insights.not_annotated"}],p=function(t){var e=c.useState(null!==t&&void 0!==t?t:""),n=(0,a.Z)(e,2),i=n[0],o=n[1];return c.useEffect((function(){o((function(e){return e!==t?t:e}))}),[t]),[i,o]},b=function(t){var e,n,i,r,l=t.filterState,b=void 0===l?{}:l,m=t.setFilterState,Z=(0,d.$G)().t,x=p(null!==(e=b.barcode)&&void 0!==e?e:""),y=(0,a.Z)(x,2),_=y[0],j=y[1],w=p(null!==(n=b.valueTag)&&void 0!==n?n:""),S=(0,a.Z)(w,2),K=S[0],C=S[1],k=p(null!==(i=b.insightType)&&void 0!==i?i:""),T=(0,a.Z)(k,2),E=T[0],O=T[1],P=p(null!==(r=b.annotationStatus)&&void 0!==r?r:""),W=(0,a.Z)(P,2),q=W[0],B=W[1],L=c.useCallback((function(){m({barcode:_,valueTag:K,insightType:E,annotationStatus:q})}),[_,K,E,q,m]);return(0,h.jsxs)(o.Z,{direction:"column",spacing:2,sx:{padding:2},children:[(0,h.jsxs)(o.Z,{direction:"row",spacing:2,children:[(0,h.jsx)(u.Z,{fullWidth:!0,label:Z("insights.barcode"),placeholder:Z("insights.barcode_placeholder"),value:_,onChange:function(t){return j(t.target.value)}}),(0,h.jsx)(u.Z,{fullWidth:!0,label:Z("insights.value_tag"),placeholder:Z("insights.value_placeholder"),value:K,onChange:function(t){return C(t.target.value)}})]}),(0,h.jsxs)(o.Z,{direction:"row",spacing:2,children:[(0,h.jsx)(u.Z,{fullWidth:!0,label:Z("insights.type"),value:E,onChange:function(t){return O(t.target.value)},select:!0,children:f.map((function(t){var e=t.value,n=t.labelKey;return(0,h.jsx)(s.Z,{value:e,children:Z(n)},e)}))}),(0,h.jsx)(u.Z,{fullWidth:!0,label:Z("insights.annotated"),value:q,onChange:function(t){return B(t.target.value)},select:!0,children:v.map((function(t){var e=t.value,n=t.labelKey;return(0,h.jsx)(s.Z,{value:e,children:Z(n)},e)}))})]}),(0,h.jsx)(o.Z,{direction:"row",justifyContent:"end",children:(0,h.jsx)(g.Z,{variant:"contained",onClick:L,sx:{ml:2},children:Z("insights.search")})})]})},m=n(1413),Z=n(5987),x=n(4883),y=n(3930),_=n(7683),j=n(854),w=n(8408),S=n(2034),K=n(1394),C=n(3687),k=n(7458),T=n(610),E=n(5255),O=n(9079),P=n(3768),W=n(3547),q=["value"],B=function(t){t.value;var e=(0,Z.Z)(t,q);return(0,h.jsx)(O.Z,(0,m.Z)((0,m.Z)({component:"button"},e),{},{children:t.value}))},L=function(t){return t?W.Z.getProductUrl(t):""},U={"":"insights.all",product_weight:"insights.product_weight",label:"insights.label",category:"insights.category",expiration_date:"insights.expiration_date",packager_code:"insights.packager_code",brand:"logos.brand",packaging:"logos.packaging",qr_code:"logos.qr_code"},I={"":"insights.all","-1":"insights.skipped",0:"insights.rejected",1:"insights.accepted",not_annotated:"insights.not_annotated"},F=function(t){var e=t.value,n=(0,d.$G)().t,a=U[null!==e&&void 0!==e?e:""]?n(U[null!==e&&void 0!==e?e:""]):e;return(0,h.jsx)(l.Z,{children:a})},G=function(t){var e=t.value,n=(0,(0,d.$G)().t)(I[null!==e&&void 0!==e?e:""]);switch(e){case 1:return(0,h.jsx)(E.Z,{title:n,children:(0,h.jsx)(S.Z,{color:"success"})});case 0:return(0,h.jsx)(E.Z,{title:n,children:(0,h.jsx)(K.Z,{color:"error"})});case-1:return(0,h.jsx)(E.Z,{title:n,children:(0,h.jsx)(C.Z,{color:"warning"})});default:return null}},N={type:"dateTime",minWidth:150,maxWidth:200,flex:1,valueGetter:function(t){return t.value?new Date(t.value):null}},R=function(t){var e=t.filterState,n=void 0===e?{}:e,i=t.setFilterState,o=(0,d.$G)().t,r=c.useState({page:1,rowCount:0}),l=(0,a.Z)(r,2),u=l[0],s=l[1],g=c.useState(!1),f=(0,a.Z)(g,2),v=f[0],p=f[1],b=c.useState([]),Z=(0,a.Z)(b,2),S=Z[0],K=Z[1],C=c.useMemo((function(){return[{field:"actions",type:"actions",getActions:function(t){return[(0,h.jsx)(x.u,{component:"a",href:(e=t.row.barcode,e?W.Z.getProductEditUrl(e):""),label:o("insights.edit_product"),icon:(0,h.jsx)(E.Z,{title:o("insights.edit_product"),children:(0,h.jsx)(j.Z,{})})}),(0,h.jsx)(x.u,{component:"a",href:L(t.row.barcode),label:o("insights.view_product"),icon:(0,h.jsx)(E.Z,{title:o("insights.view_product"),children:(0,h.jsx)(w.Z,{})})})];var e}},{field:"type",minWidth:150,flex:1,maxWidth:200,renderCell:function(t){return(0,h.jsx)(F,(0,m.Z)({},t))}},{field:"value_tag",minWidth:200,flex:1,renderCell:function(t){var e,n,a=t.row;return a.type&&a.value_tag?(0,h.jsxs)(O.Z,{href:(e=a.type,n=a.value_tag,n&&["category","brand","product_weight","label"].includes(e)?"/questions?type=".concat(e,"&value_tag=").concat(n):""),children:[a.value_tag," : ",a.value]}):(0,h.jsxs)("span",{children:[a.value_tag," : ",a.value]})}},{field:"barcode",renderCell:function(t){var e=t.value,n=t.tabIndex;return(0,h.jsx)(B,{value:e,tabIndex:n,onClick:function(){i((function(t){return(0,m.Z)((0,m.Z)({},t),{},{barcode:e})}))}})},minWidth:180,flex:1,maxWidth:200},{field:"id",flex:1},(0,m.Z)({field:"timestamp"},N),(0,m.Z)({field:"completed_at"},N),{field:"annotation",renderCell:function(t){return(0,h.jsx)(G,(0,m.Z)({},t))},minWidth:70,maxWidth:110,flex:1},{field:"automatic_processing",type:"boolean",valueGetter:function(t){var e=t.value;return Boolean(e)},minWidth:70,flex:1,maxWidth:110,renderCell:function(t){return t.value?(0,h.jsx)(E.Z,{title:o("insights.automatic"),children:(0,h.jsx)(T.Z,{color:"action"})}):(0,h.jsx)(E.Z,{title:o("insights.human_required"),children:(0,h.jsx)(k.Z,{color:"action"})})}}].map((function(t){return(0,m.Z)((0,m.Z)({},t),{},{sortable:!1})}))}),[i,o]);return c.useEffect((function(){p(!0);var t=!0;return P.Z.getInsights(n.barcode,n.insightType,n.valueTag,n.annotationStatus,u.page,25).then((function(e){if(t){var n=e.data.count;s((function(t){return n!==t.rowCount?(0,m.Z)((0,m.Z)({},t),{},{rowCount:n}):t})),K(e.data.insights.map((function(t){var e;return(0,m.Z)((0,m.Z)({},t),{},{value_tag:null!==(e=t.value_tag)&&void 0!==e?e:t.value})}))),p(!1)}})).catch((function(){t&&p(!1)})),function(){t=!1}}),[n.barcode,n.valueTag,n.insightType,n.annotationStatus,u.page,o]),(0,h.jsx)(y._,{autoHeight:!0,columns:C,rows:S,disableColumnFilter:!0,disableCol:!0,componentsProps:{toolbar:{printOptions:{disableToolbarButton:!0},csvOptions:{disableToolbarButton:!0}}},components:{Toolbar:_.n},isLoading:v,page:u.page-1,pageSize:25,rowsPerPageOptions:[25],onPageChange:function(t){return s((function(e){return(0,m.Z)((0,m.Z)({},e),{},{page:t+1})}))},paginationMode:"server",rowCount:u.rowCount,density:"compact",initialState:{columns:{columnVisibilityModel:{id:!1}}}})},J=n(2068);function V(){var t=(0,d.$G)().t,e=(0,J.ZP)({barcode:"",valueTag:"",insightType:"",annotationStatus:""},{valueTag:["value","value_tag"]}),n=(0,a.Z)(e,2),u=n[0],s=n[1];return(0,h.jsx)(c.Suspense,{fallback:(0,h.jsx)(i.Z,{}),children:(0,h.jsxs)(o.Z,{spacing:2,sx:{padding:2},children:[(0,h.jsx)(l.Z,{children:t("insights.insights")}),(0,h.jsx)(b,{filterState:u,setFilterState:s}),(0,h.jsx)(r.Z,{}),(0,h.jsx)("div",{style:{height:"250px"},children:(0,h.jsx)(R,{filterState:u,setFilterState:s})})]})})}},3768:function(t,e,n){var a=n(9439),i=n(1413),o=n(8025),r=n.n(o),c=n(9025),l=n(3843),u=n(5886),s={annotate:function(t,e){if(!c.rp)return r().post("".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(t,"&annotation=").concat(e,"&update=1")),{withCredentials:!0});console.log("Annotated, ".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(t,"&annotation=").concat(e,"&update=1")),{withCredentials:!0})},questionsByProductCode:function(t){return r().get("".concat(c.oK,"/questions/").concat(t)).then((function(t){var e=t.data.questions;return t.data.questions=e.filter((function(t){return t.source_image_url})),t}))},questions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=t.insightType,o=t.brandFilter,s=t.valueTag,g=t.countryFilter,d=t.sortByPopularity,h=t.campaign,f=t.predictor,v={insight_types:a,value_tag:s,brands:(0,u.Ii)(o),country:"en:world"!==g?g:null,campaign:h,predictor:f},p=(0,l.VQ)();return r().get("".concat(c.oK,"/questions/").concat(d?"popular":"random"),{params:(0,u.BE)((0,i.Z)((0,i.Z)({},v),{},{lang:p,count:e,page:n}))})},insightDetail:function(t){return r().get("".concat(c.oK,"/insights/detail/").concat(t))},loadLogo:function(t){return r().get("".concat(c.oK,"/images/logos/").concat(t))},updateLogo:function(t,e,n){return r().put("".concat(c.oK,"/images/logos/").concat(t),(0,u.BE)({value:e,type:n}),{withCredentials:!0})},searchLogos:function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=["label","category"].includes(n)?{taxonomy_value:e}:{value:e};return r().get("".concat(c.oK,"/images/logos/search/"),{params:(0,u.BE)((0,i.Z)({barcode:t,type:n,count:a,random:o},l))})},getLogoAnnotations:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,a=t.length>0?"".concat(c.oK,"/ann/search/").concat(t):"".concat(c.oK,"/ann/search");return r().get(a,{params:(0,u.BE)({index:e,count:n})})},annotateLogos:function(t){return r().post("".concat(c.oK,"/images/logos/annotate"),(0,u.BE)({annotations:t}),{withCredentials:!0})},getInsights:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:25;return i.length&&"not_annotated"===i&&(t="0",i=""),r().get("".concat(c.oK,"/insights"),{params:(0,u.BE)({barcode:e,insight_types:n,value_tag:a,annotation:i,page:o,annotated:t,count:l})})},getUserStatistics:function(t){return r().get("".concat(c.oK,"/users/statistics/").concat(t))},getCroppedImageUrl:function(t,e){var n=(0,a.Z)(e,4),i=n[0],o=n[1],r=n[2],l=n[3];return"".concat(c.oK,"/images/crop?image_url=").concat(t,"&y_min=").concat(i,"&x_min=").concat(o,"&y_max=").concat(r,"&x_max=").concat(l)},getLogosImages:function(t){return r().get("".concat(c.oK,"/images/logos?logo_ids=").concat(t.join(",")))},getNutritionValueFromImage:function(t,e,n){var a=e.split("/"),i=a[5],o="nutrition_".concat(t);for(var l in n)if(o===l)var u=n[o].imgid;return a.length>7&&(i=a[5]+"/"+a[6]+"/"+a[7]+"/"+a[8]),r().get("".concat(c.oK,"/predict/nutrient?ocr_url=https://images.openfoodfacts.org/images/products/").concat(i,"/").concat(u,".json"))},getUnansweredValues:function(t){var e,n=null!==(e=t.page)&&void 0!==e?e:1;return n=n>=1?n:1,r().get("".concat(c.oK,"/questions/unanswered/?").concat(Object.keys((0,i.Z)((0,i.Z)({},t),{},{page:n})).filter((function(e){return void 0!==t[e]})).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&")))}};e.Z=s},5886:function(t,e,n){n.d(e,{BE:function(){return r},Ii:function(){return o},VS:function(){return l},_v:function(){return c}});var a=n(9439),i={" ":"-","'":"-","&":"","\xe0":"a","\xe2":"a","\xe4":"a","\xe9":"e","\xe8":"e","\xea":"e","\xeb":"e","\xee":"i","\xef":"i","\xf4":"o","\xf6":"o","\xfb":"u","\xf9":"u","\xfc":"u"},o=function(t){if(!t)return t;for(var e=t.trim().toLowerCase(),n=0,o=Object.entries(i);n<o.length;n++){var r=(0,a.Z)(o[n],2),c=r[0],l=r[1];e=e.replace(new RegExp(c,"g"),l)}return e=e.replace(/-{2,}/g,"-")},r=function(t){return Object.keys(t).forEach((function(e){return(null==t[e]||""===t[e])&&delete t[e]})),t};function c(t){return new Promise((function(e){return setTimeout(e,t)}))}var l=function(t){if(!t)return t;var e=t.slice(3);return e.charAt(0).toUpperCase()+e.slice(1)}}}]);
//# sourceMappingURL=97.1899b77a.chunk.js.map