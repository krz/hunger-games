"use strict";(self.webpackChunkhunger_game=self.webpackChunkhunger_game||[]).push([[59],{9524:function(n,e,t){var o=t(1413),a=t(5987),i=t(4165),r=t(5861),c=t(9439),u=t(9867),l=t(3248),s=t(3865),g=t(3911),d=t(829),f=t(2418),p=t(9421),v=t(2834),m=["value","type","updateMode","request","isLoading"],h=["packager_code","qr_code","no_logo"],Z=[{value:"",labelKey:"logos.type"},{value:"label",labelKey:"logos.label"},{value:"brand",labelKey:"logos.brand"},{value:"packager_code",labelKey:"logos.packager_code"},{value:"packaging",labelKey:"logos.packaging"},{value:"qr_code",labelKey:"logos.qr_code"},{value:"category",labelKey:"logos.category"},{value:"nutrition_label",labelKey:"logos.nutrition_label"},{value:"store",labelKey:"logos.store"},{value:"no_logo",labelKey:"logos.no_logo"}],y=function(n){var e=n.type,t=n.value;return 0!==e.length&&!(!t&&!h.includes(e))},x=function(n){var e=n.type,t=n.value;if(!y({type:e,value:t}))return null;var o=t.toLowerCase().trim();return h.includes(e)&&(o=""),{type:e,value:o}};e.Z=function(n){var e=n.value,t=n.type,b=n.updateMode,_=n.request,j=n.isLoading,L=(0,a.Z)(n,m),C=(0,f.$G)().t,w=function(n,e,t){var o=u.useState(!1),a=(0,c.Z)(o,2),l=a[0],s=a[1],g=u.useState(n),d=(0,c.Z)(g,2),f=d[0],p=d[1],v=u.useState(e),m=(0,c.Z)(v,2),Z=m[0],b=m[1];u.useLayoutEffect((function(){p(n)}),[n]),u.useLayoutEffect((function(){b(e)}),[e]);var _=u.useCallback((0,r.Z)((0,i.Z)().mark((function n(){return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(!0),n.next=3,t(x({type:Z,value:f}));case 3:s(!1);case 4:case"end":return n.stop()}}),n)}))),[t,Z,f]),j=Z!==e||!h.includes(Z)&&(null!==f?f.toLowerCase()!==n.toLowerCase():f!==n),L=y({type:Z||"",value:f}),C=["label","category","packaging"].includes(Z);return{isSending:l,send:_,isDifferent:j,hasAutoComplet:C,isValid:L,typeControl:{value:Z,onChange:function(n){return b(n.target.value)}},valueControl:{insightType:C?Z:void 0,value:f,onChange:C?function(n){return p(n)}:function(n){return p(n.target.value)}}}}(e,t,_),k=w.isSending,K=w.send,U=w.isDifferent,I=w.isValid,S=w.hasAutoComplet,E=w.typeControl,V=w.valueControl;return(0,v.jsxs)(l.Z,(0,o.Z)((0,o.Z)({direction:{xs:"column",md:"row"},spacing:{xs:1,sm:2,md:4}},L),{},{children:[(0,v.jsx)(s.Z,(0,o.Z)((0,o.Z)({},E),{},{select:!0,label:C("logos.type"),sx:{minWidth:{xs:"80%",sm:350}},size:"small",children:Z.map((function(n){var e=n.value,t=n.labelKey;return(0,v.jsx)(g.Z,{value:e,children:C(t)},t)}))})),S?(0,v.jsx)(p.Z,(0,o.Z)((0,o.Z)({showKey:!0},V),{},{label:C("logos.value"),size:"small",sx:{minWidth:{xs:"80%",sm:350}}})):(0,v.jsx)(s.Z,(0,o.Z)((0,o.Z)({},V),{},{label:C("logos.value"),sx:{minWidth:{xs:"80%",sm:350}},size:"small"})),(0,v.jsx)(d.Z,{onClick:K,loading:k,disabled:j||!I||b&&!U,variant:"contained",color:"primary",children:C("logos.update")})]}))}},9421:function(n,e,t){var o=t(5987),a=t(1413),i=t(3433),r=t(9439),c=t(9867),u=t(2915),l=t(3865),s=t(3843),g=t(8025),d=t.n(g),f=t(9025),p=t(2834),v=["showKey","onChange","value","insightType","fullWidth"],m=["de","es","fr","hr","nl","sv"],h=function(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^0-9a-z]/gi," ")};e.Z=function(n){var e=n.showKey,t=n.onChange,g=n.value,Z=n.insightType,y=n.fullWidth,x=(0,o.Z)(n,v),b=c.useState(null),_=(0,r.Z)(b,2),j=_[0],L=_[1],C=c.useState(""),w=(0,r.Z)(C,2),k=w[0],K=w[1],U=(0,s.VQ)(),I=function(n,e,t){var o=c.useState([]),u=(0,r.Z)(o,2),l=u[0],s=u[1],g=c.useRef({});return c.useEffect((function(){s([]),g.current={}}),[n]),c.useEffect((function(){var o=e.toLowerCase();/^[a-z][a-z]:/.test(o)&&(o=o.slice(3)),[(o=o.replace(/[^0-9a-z]/gi,"-")).slice(0,1),o.slice(0,2),o.slice(0,3)].forEach((function(e){e.length>0&&!g.current[e]&&(g.current[e]=!0,d().get("".concat(f.pV,"/data/").concat(m.includes(t)?t:"en","/").concat(n,"/").concat(e,".json")).then((function(n){var e=n.data;s((function(n){var t=n.map((function(n){return n.key}));return[].concat((0,i.Z)(n),(0,i.Z)(e.filter((function(n){var e=n.key;return!t.includes(e)})).map((function(n){return(0,a.Z)((0,a.Z)({},n),{},{cleanName:h(n.name)})}))))}))})).catch((function(){})))}))}),[e,n,t]),l}(Z,k,U);return c.useEffect((function(){L((function(n){if("object"===typeof n&&(null===n||void 0===n?void 0:n.key)===g)return n;var e=I.find((function(n){return n.key===g}));return e||g}))}),[g,I]),(0,p.jsx)(u.Z,{fullWidth:y,freeSolo:!0,onChange:function(n,e){var o;L(e),t(null!==(o=null===e||void 0===e?void 0:e.key)&&void 0!==o?o:e)},onInputChange:function(n,e,t){K(e)},onBlur:function(){("string"===typeof j?j===k:j.name===k)||(L(k),t(k))},inputValue:k,value:j,options:I,getOptionLabel:function(n){var e;return null!==(e=null===n||void 0===n?void 0:n.name)&&void 0!==e?e:n},renderInput:function(n){return(0,p.jsx)(l.Z,(0,a.Z)((0,a.Z)((0,a.Z)({},n),x),{},{helperText:e&&((null===j||void 0===j?void 0:j.key)||""!==j&&null!==j&&'\u26a0\ufe0f unknown: "'.concat(j,'"'))}))},filterOptions:function(n,e){return n.filter((function(n){return null===n||void 0===n?void 0:n.cleanName.includes(h(e.inputValue))}))}})}},3449:function(n,e,t){var o=t(8025),a=t.n(o),i={addImageFlag:function(n){var e=n.barcode,t=n.imgid,o=n.url;a().put("https://amathjourney.com/api/off-annotation/flag-image/".concat(e),{mode:"no-cors",imgid:t,url:o}).catch((function(){console.log("Image flagged")}))},removeImageFlag:function(n){var e=n.barcode,t=n.imgid;a().delete("https://amathjourney.com/api/off-annotation/flag-image/".concat(e),{mode:"no-cors",data:{imgid:t}}).catch((function(){console.log("Something went wrong. Image could not be flagged")}))}};e.ZP=i},3059:function(n,e,t){t.r(e),t.d(e,{default:function(){return I}});var o=t(1413),a=t(4165),i=t(5861),r=t(9439),c=t(9867),u=t(4670),l=t(9524),s=t(3768),g=t(3547),d=t(3449),f=t(9025),p=t(5255),v=t(9346),m=t(3248),h=t(8386),Z=t(8547),y=t(4964),x=t(5226),b=t(7298),_=t(1731),j=t(1526),L=t(2418),C=t(5886),w=t(8514),k=t(2834),K=function(n){return g.Z.getImageUrl(n.image.source_image)},U=function(n){var e=n.logoId,t=n.image_id,o=n.annotationValue,u=void 0===o?"":o,g=n.annotationType,w=void 0===g?"":g,K=n.imageURL,U=n.cropURL,I=n.barcode,S=n.isLoading,E=(0,L.$G)().t,V=c.useState(!1),R=(0,r.Z)(V,2),q=R[0],T=R[1],B=c.useState(!1),z=(0,r.Z)(B,2),F=z[0],P=z[1],W=c.useCallback((function(n){return function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){var o,i;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:if(o=t.type,i=t.value,!f.rp){e.next=9;break}return e.next=6,(0,C._v)(2e3);case 6:console.log("Updated"),e.next=11;break;case 9:return e.next=11,s.Z.updateLogo(n,i,o);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}),[]);return(0,k.jsxs)(b.Z,{sx:{margin:"2% 10%"},children:[(0,k.jsx)(h.Z,{open:q,onClose:function(){return T(!1)},children:(0,k.jsx)("img",{src:K,alt:"",style:{maxWidth:"90vw",maxHeight:"90vh"}})}),(0,k.jsxs)(m.Z,{spacing:2,children:[(0,k.jsx)(Z.Z,{variant:"h2",sx:{fontSize:"1.5rem",fontWeight:600,marginBottom:2},children:E("logos.detail")}),(0,k.jsxs)(Z.Z,{children:[E("logos.id")," ",e]}),(0,k.jsxs)(Z.Z,{children:[E("logos.barcode")," ",I]}),(0,k.jsx)("img",{width:"300px",src:U,alt:E("logos.crop_image_title")}),(0,k.jsxs)(m.Z,{direction:"row",children:[(0,k.jsx)(y.Z,{variant:"contained",sx:{width:200,mr:5},onClick:function(){T(!0)},children:E("logos.full_image")}),F?(0,k.jsx)(p.Z,{title:E("logos.unflag"),children:(0,k.jsx)(v.Z,{onClick:function(){d.ZP.deleteImageFlag({barcode:I,imgid:t}),P(!1)},children:(0,k.jsx)(j.Z,{})})}):(0,k.jsx)(p.Z,{title:E("logos.flag"),children:(0,k.jsx)(v.Z,{onClick:function(){d.ZP.addImageFlag({barcode:I,imgid:t,url:K}),P(!0)},children:(0,k.jsx)(_.Z,{})})})]}),(0,k.jsx)(x.Z,{}),(0,k.jsx)(l.Z,{value:u,type:w,updateMode:!0,request:W(e),isLoading:S})]})]})};function I(){var n=this,e=(0,u.UO)().logoId,t=c.useState({annotationValue:"",annotationType:"",imageURL:"",cropURL:"",barcode:"",isLoading:!1}),a=(0,r.Z)(t,2),i=a[0],l=a[1];return c.useEffect((function(){var t=!0;return l({annotationValue:"",annotationType:"",imageURL:"",image_id:"",cropURL:"",barcode:"",isLoading:!0}),s.Z.loadLogo(e).then((function(n){var e,o=n.data;t&&l({imageURL:K(o),image_id:o.image.image_id,cropURL:(e=o,s.Z.getCroppedImageUrl(K(e),e.bounding_box)),annotationValue:o.annotation_value||"",annotationType:o.annotation_type||"",barcode:o.image.barcode,isLoading:!1})})).catch((function(){t&&(l((function(){return{annotationValue:"",annotationType:"",imageURL:"",image_id:"",cropURL:"",barcode:"",isLoading:!1}})),n.isLoading=!1)})),function(){t=!1}}),[e]),(0,k.jsx)(c.Suspense,{fallback:(0,k.jsx)(w.Z,{}),children:(0,k.jsx)(U,(0,o.Z)((0,o.Z)({},i),{},{logoId:e}))})}},3768:function(n,e,t){var o=t(9439),a=t(1413),i=t(8025),r=t.n(i),c=t(9025),u=t(3843),l=t(5886),s={annotate:function(n,e){if(!c.rp)return r().post("".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(n,"&annotation=").concat(e,"&update=1")),{withCredentials:!0});console.log("Annotated, ".concat(c.oK,"/insights/annotate"),new URLSearchParams("insight_id=".concat(n,"&annotation=").concat(e,"&update=1")),{withCredentials:!0})},questionsByProductCode:function(n){return r().get("".concat(c.oK,"/questions/").concat(n)).then((function(n){var e=n.data.questions;return n.data.questions=e.filter((function(n){return n.source_image_url})),n}))},questions:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=n.insightType,i=n.brandFilter,s=n.valueTag,g=n.countryFilter,d=n.sortByPopularity,f=n.campaign,p=n.predictor,v={insight_types:o,value_tag:s,brands:(0,l.Ii)(i),country:"en:world"!==g?g:null,campaign:f,predictor:p},m=(0,u.VQ)();return r().get("".concat(c.oK,"/questions/").concat(d?"popular":"random"),{params:(0,l.BE)((0,a.Z)((0,a.Z)({},v),{},{lang:m,count:e,page:t}))})},insightDetail:function(n){return r().get("".concat(c.oK,"/insights/detail/").concat(n))},loadLogo:function(n){return r().get("".concat(c.oK,"/images/logos/").concat(n))},updateLogo:function(n,e,t){return r().put("".concat(c.oK,"/images/logos/").concat(n),(0,l.BE)({value:e,type:t}),{withCredentials:!0})},searchLogos:function(n,e,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:25,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=["label","category"].includes(t)?{taxonomy_value:e}:{value:e};return r().get("".concat(c.oK,"/images/logos/search/"),{params:(0,l.BE)((0,a.Z)({barcode:n,type:t,count:o,random:i},u))})},getLogoAnnotations:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,o=n.length>0?"".concat(c.oK,"/ann/search/").concat(n):"".concat(c.oK,"/ann/search");return r().get(o,{params:(0,l.BE)({index:e,count:t})})},annotateLogos:function(n){return r().post("".concat(c.oK,"/images/logos/annotate"),(0,l.BE)({annotations:n}),{withCredentials:!0})},getInsights:function(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:25;return a.length&&"not_annotated"===a&&(n="0",a=""),r().get("".concat(c.oK,"/insights"),{params:(0,l.BE)({barcode:e,insight_types:t,value_tag:o,annotation:a,page:i,annotated:n,count:u})})},getUserStatistics:function(n){return r().get("".concat(c.oK,"/users/statistics/").concat(n))},getCroppedImageUrl:function(n,e){var t=(0,o.Z)(e,4),a=t[0],i=t[1],r=t[2],u=t[3];return"".concat(c.oK,"/images/crop?image_url=").concat(n,"&y_min=").concat(a,"&x_min=").concat(i,"&y_max=").concat(r,"&x_max=").concat(u)},getLogosImages:function(n){return r().get("".concat(c.oK,"/images/logos?logo_ids=").concat(n.join(",")))},getNutritionValueFromImage:function(n,e,t){var o=e.split("/"),a=o[5],i="nutrition_".concat(n);for(var u in t)if(i===u)var l=t[i].imgid;return o.length>7&&(a=o[5]+"/"+o[6]+"/"+o[7]+"/"+o[8]),r().get("".concat(c.oK,"/predict/nutrient?ocr_url=https://images.openfoodfacts.org/images/products/").concat(a,"/").concat(l,".json"))},getUnansweredValues:function(n){var e,t=null!==(e=n.page)&&void 0!==e?e:1;return t=t>=1?t:1,r().get("".concat(c.oK,"/questions/unanswered/?").concat(Object.keys((0,a.Z)((0,a.Z)({},n),{},{page:t})).filter((function(e){return void 0!==n[e]})).map((function(e){return"".concat(e,"=").concat(n[e])})).join("&")))}};e.Z=s},5886:function(n,e,t){t.d(e,{BE:function(){return r},Ii:function(){return i},VS:function(){return u},_v:function(){return c}});var o=t(9439),a={" ":"-","'":"-","&":"","\xe0":"a","\xe2":"a","\xe4":"a","\xe9":"e","\xe8":"e","\xea":"e","\xeb":"e","\xee":"i","\xef":"i","\xf4":"o","\xf6":"o","\xfb":"u","\xf9":"u","\xfc":"u"},i=function(n){if(!n)return n;for(var e=n.trim().toLowerCase(),t=0,i=Object.entries(a);t<i.length;t++){var r=(0,o.Z)(i[t],2),c=r[0],u=r[1];e=e.replace(new RegExp(c,"g"),u)}return e=e.replace(/-{2,}/g,"-")},r=function(n){return Object.keys(n).forEach((function(e){return(null==n[e]||""===n[e])&&delete n[e]})),n};function c(n){return new Promise((function(e){return setTimeout(e,n)}))}var u=function(n){if(!n)return n;var e=n.slice(3);return e.charAt(0).toUpperCase()+e.slice(1)}}}]);
//# sourceMappingURL=59.cc5a4fcf.chunk.js.map